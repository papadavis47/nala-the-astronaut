---
import { Image } from 'astro:assets';

interface Props {
  filename: string;
  alt: string;
  class?: string;
  loading?: 'lazy' | 'eager';
  widths?: number[];
  sizes?: string;
}

const { filename, alt, class: className, loading = 'lazy', widths, sizes } = Astro.props;

const images = import.meta.glob<{ default: ImageMetadata }>(
  '../images/*.webp',
  { eager: true }
);

const imagePath = `../images/${filename}.webp`;
const image = images[imagePath]?.default;

if (!image) {
  throw new Error(`Image not found: ${filename}.webp`);
}
---

<Image
  src={image}
  alt={alt}
  loading={loading}
  widths={widths}
  sizes={sizes}
  class:list={["rounded-lg", className]}
/>
